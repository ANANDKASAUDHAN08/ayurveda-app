<div (click)="openDetails()" class="group bg-white rounded-xl sm:rounded-2xl shadow-md sm:shadow-lg overflow-hidden 
            hover:shadow-xl sm:hover:shadow-2xl hover:-translate-y-1 sm:hover:-translate-y-2 
            transition-all duration-300 cursor-pointer
            border border-gray-100 sm:border-2 sm:border-transparent sm:hover:border-emerald-400
            flex flex-col">

    <!-- Pharmacy Image with Gradient Overlay -->
    <div
        class="relative w-full h-20 md:h-32 flex-shrink-0 overflow-hidden bg-gradient-to-br from-emerald-400 via-teal-500 to-cyan-500">
        <img *ngIf="pharmacy.image_url" [src]="pharmacy.image_url" [alt]="pharmacy.name || 'Pharmacy'"
            class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">

        <!-- Placeholder if no image -->
        <div *ngIf="!pharmacy.image_url"
            class="w-full h-full flex items-center justify-center bg-gradient-to-br from-emerald-400 via-teal-500 to-cyan-500">
            <i class="fas fa-pills text-white text-2xl sm:text-4xl opacity-30"></i>
        </div>

        <!-- Gradient Overlay -->
        <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>

        <!-- Top Actions (Favorite & Share) -->
        <div class="absolute -right-4 -top-1 md:top-1 md:right-2 flex items-center gap-0 md:gap-0.5 z-30">
            <!-- Share Button -->
            <app-share-button [shareData]="shareData"
                customClass="w-3 h-3 md:w-7 md:h-7 p-0 md:p-1 transition-all duration-300 hover:scale-110 active:scale-90 hover:text-blue-900 text-white text-[12px] md:text-sm !bg-transparent !border-0 !shadow-none">
            </app-share-button>

            <!-- Favorite Toggle -->
            <button (click)="toggleFavorite($event)"
                class="p-0 md:p-1 transition-all duration-300 group/fav hover:scale-110 active:scale-90"
                aria-label="Toggle Favorite">
                <svg xmlns="http://www.w3.org/2000/svg" [attr.fill]="isFavorite() ? '#ef4444' : 'none'"
                    [attr.stroke]="isFavorite() ? '#ef4444' : 'white'" viewBox="0 0 24 24" stroke-width="2.5"
                    class="w-4 h-4 md:w-5 md:h-5 transition-all duration-300" [class.scale-110]="isFavorite()">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
                </svg>
            </button>
        </div>

        <!-- Service Badges -->
        <div class="absolute top-1 left-1 sm:top-2 sm:left-2 flex flex-col gap-1 sm:gap-1.5">
            <span *ngIf="pharmacy.is_24x7 || pharmacy.opening_hours === '24/7'"
                class="bg-blue-500 text-white px-1 py-0.5 sm:px-2.5 sm:py-1 rounded-full text-[7px] sm:text-[10px] font-bold shadow-lg">
                24Ã—7
            </span>
        </div>
    </div>

    <!-- Pharmacy Info -->
    <div class="p-3 flex-1 flex flex-col justify-between min-w-0">
        <div class="space-y-1 sm:space-y-1.5">
            <!-- Brand Tag if available -->
            <div *ngIf="pharmacy.brand && pharmacy.brand !== 'Independent'"
                class="hidden sm:block text-[8px] font-black text-emerald-600 uppercase tracking-widest">
                {{pharmacy.brand}}
            </div>

            <!-- Name -->
            <h3
                class="text-sm sm:text-lg font-bold text-gray-900 group-hover:text-emerald-600 transition-colors line-clamp-2">
                {{pharmacy.name || 'Unnamed Pharmacy'}}
            </h3>

            <!-- Location -->
            <div class="flex items-start gap-1 text-gray-500">
                <i class="fas fa-map-marker-alt text-emerald-600 mt-0.5 flex-shrink-0 text-[10px] sm:text-xs"></i>
                <span class="text-[10px] sm:text-xs line-clamp-1">
                    {{pharmacy.city || 'N/A'}}<span *ngIf="pharmacy.state">, {{pharmacy.state}}</span>
                </span>
            </div>

            <!-- Contact Info - Compact -->
            <div class="hidden sm:flex flex-wrap gap-x-2 gap-y-1 items-center pt-1">
                <div *ngIf="pharmacy.phone && pharmacy.phone !== 'N/A'"
                    class="flex items-center gap-1 text-[10px] text-gray-600">
                    <i class="fas fa-phone text-emerald-600"></i>
                    <span>{{pharmacy.phone}}</span>
                </div>
                <div *ngIf="pharmacy.delivery_available"
                    class="flex items-center gap-1 text-[10px] font-bold text-emerald-600">
                    <i class="fas fa-truck"></i>
                    <span>Delivery</span>
                </div>
            </div>
        </div>

        <!-- View Details Button -->
        <button class="hidden sm:flex w-full px-4 py-1.5 bg-emerald-50 text-emerald-700 
                       hover:bg-emerald-600 hover:text-white font-bold rounded-lg 
                       transition-all duration-300 items-center justify-center gap-2 group/btn mt-2">
            <span class="text-sm">View Details</span>
            <i class="fas fa-arrow-right text-xs group-hover/btn:translate-x-1 transition-transform"></i>
        </button>
    </div>
</div>

<!-- Details Modal Component -->
<app-pharmacy-details-modal [pharmacy]="pharmacy" [isOpen]="showModal" (close)="closeModal()">
</app-pharmacy-details-modal>