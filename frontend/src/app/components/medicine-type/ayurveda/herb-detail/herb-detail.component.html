<!-- Global Herb Detail Modal Overlay -->
<div class="fixed inset-0 z-[99999] p-4 md:p-10 bg-black/40 backdrop-blur-md flex items-start justify-center overflow-y-auto"
    (click)="onClose()">

    <div class="bg-white rounded-[2.5rem] w-full max-w-5xl max-h-[92vh] overflow-hidden shadow-2xl flex flex-col animate-in slide-in-from-bottom-5 duration-500"
        (click)="$event.stopPropagation()">

        <!-- Compact Header -->
        <div
            class="relative px-8 py-5 bg-gradient-to-br from-emerald-950 via-emerald-900 to-emerald-800 text-white overflow-hidden shrink-0">
            <div class="absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full -mr-20 -mt-20 blur-[80px]"></div>

            <div class="relative flex justify-between items-center">
                <div class="flex items-center gap-6">
                    <div
                        class="w-12 h-12 bg-white/10 backdrop-blur-md rounded-2xl flex items-center justify-center text-2xl shadow-inner group-hover:scale-110 transition-transform">
                        üåø
                    </div>
                    <div>
                        <div class="flex items-center gap-3 mb-0.5">
                            <span class="text-[9px] font-black uppercase tracking-[0.2em] opacity-60">
                                {{ herb.scientific_name }}
                            </span>
                            <span *ngIf="herb.tridosha"
                                class="px-2 py-0.5 bg-purple-500/20 backdrop-blur-md rounded-full text-[8px] font-black uppercase tracking-widest text-purple-200 border border-purple-500/30">
                                Tridoshic
                            </span>
                        </div>
                        <h2 class="text-2xl md:text-3xl font-black tracking-tight serif-font italic leading-none">{{
                            herb.name }}</h2>
                    </div>
                </div>

                <button (click)="onClose()"
                    class="w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 backdrop-blur-md flex items-center justify-center group transition-all">
                    <span class="text-xl group-hover:rotate-90 transition-transform duration-300">‚úï</span>
                </button>
            </div>
        </div>

        <!-- Single Page Content -->
        <div class="flex-1 overflow-y-auto p-8 md:p-10 space-y-12 bg-[#fafafc] custom-scrollbar">

            <!-- Quick Energetics Strip -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="bg-white p-6 rounded-3xl border border-stone-100 shadow-sm flex flex-col justify-between">
                    <span class="text-[9px] font-black text-emerald-800/40 uppercase tracking-widest mb-3">Rasa
                        (Taste)</span>
                    <div class="flex flex-wrap gap-1.5">
                        <span *ngFor="let r of herb.rasa"
                            class="text-xs font-bold text-emerald-950 px-2 py-0.5 bg-emerald-50 rounded-md">{{ r
                            }}</span>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-3xl border border-stone-100 shadow-sm flex flex-col justify-between">
                    <span class="text-[9px] font-black text-orange-800/40 uppercase tracking-widest mb-3">Virya
                        (Potency)</span>
                    <span class="text-sm font-bold text-orange-950 px-2 py-0.5 bg-orange-50 rounded-md inline-block">{{
                        herb.virya }}</span>
                </div>
                <div class="bg-white p-6 rounded-3xl border border-stone-100 shadow-sm flex flex-col justify-between">
                    <span class="text-[9px] font-black text-blue-800/40 uppercase tracking-widest mb-3">Vipaka
                        (Post-Digestion)</span>
                    <span class="text-sm font-bold text-blue-950 px-2 py-0.5 bg-blue-50 rounded-md inline-block">{{
                        herb.vipaka }}</span>
                </div>
                <div class="bg-white p-6 rounded-3xl border border-stone-100 shadow-sm flex flex-col justify-between">
                    <span class="text-[9px] font-black text-stone-400 uppercase tracking-widest mb-3">Guna
                        (Quality)</span>
                    <div class="flex flex-wrap gap-1.5">
                        <span *ngFor="let g of herb.guna"
                            class="text-xs font-bold text-stone-900 px-2 py-0.5 bg-stone-50 rounded-md">{{ g }}</span>
                    </div>
                </div>
            </div>

            <!-- Main Layout: Image & Profile -->
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
                <!-- Image & Dosha -->
                <div class="lg:col-span-12">
                    <div class="flex flex-col lg:flex-row gap-10">
                        <div class="lg:w-1/2">
                            <div
                                class="aspect-[21/10] w-full rounded-[2rem] overflow-hidden shadow-2xl border-4 border-white">
                                <img [src]="herb.image_url" class="w-full h-full object-cover">
                            </div>
                        </div>
                        <div class="lg:w-1/2 space-y-6">
                            <h3 class="text-xs font-black uppercase tracking-[0.3em] text-emerald-800">Therapeutic
                                Profile</h3>
                            <p class="text-3xl text-stone-900 font-bold leading-tight serif-font italic">"{{
                                herb.preview || herb.description.split('.')[0] + '.' }}"</p>

                            <div class="space-y-4">
                                <div
                                    class="p-6 bg-emerald-50 rounded-[2rem] border border-emerald-100/50 flex items-center justify-between">
                                    <span
                                        class="text-[10px] font-black text-emerald-900 uppercase tracking-widest">Balances</span>
                                    <div class="flex gap-2">
                                        <span *ngFor="let d of herb.pacify"
                                            class="px-3 py-1 bg-white text-emerald-800 rounded-lg text-[10px] font-black uppercase border border-emerald-100">{{
                                            d }}</span>
                                    </div>
                                </div>
                                <div *ngIf="herb.aggravate.length > 0"
                                    class="p-6 bg-orange-50 rounded-[2rem] border border-orange-100/50 flex items-center justify-between">
                                    <span
                                        class="text-[10px] font-black text-orange-900 uppercase tracking-widest">Caution
                                        for</span>
                                    <div class="flex gap-2">
                                        <span *ngFor="let d of herb.aggravate"
                                            class="px-3 py-1 bg-white text-orange-800 rounded-lg text-[10px] font-black uppercase border border-orange-100">{{
                                            d }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Deep Knowledge -->
                <div class="lg:col-span-12">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
                        <div class="space-y-6">
                            <div class="flex items-center gap-3">
                                <span class="w-1.5 h-6 bg-emerald-600 rounded-full"></span>
                                <h3 class="text-sm font-black uppercase tracking-widest text-emerald-900">Botanical
                                    Description</h3>
                            </div>
                            <p class="text-lg text-gray-700 leading-relaxed font-medium">
                                {{ herb.description }}
                            </p>

                            <div class="pt-6 border-t border-stone-200/50">
                                <div class="flex justify-between items-center">
                                    <div class="space-y-1">
                                        <p class="text-[10px] font-black text-emerald-800/40 uppercase tracking-widest">
                                            Botanical Name</p>
                                        <p class="text-sm font-bold text-emerald-950">{{ herb.scientific_name }}</p>
                                    </div>
                                    <a [href]="herb.link" target="_blank"
                                        class="px-6 py-3 bg-white text-emerald-900 border-2 border-emerald-50 rounded-2xl font-black uppercase tracking-widest text-[9px] hover:bg-emerald-50 transition-all">
                                        Botanical Research ‚Üí
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div
                                class="bg-emerald-950 p-10 rounded-[3rem] text-white relative overflow-hidden shadow-2xl">
                                <div
                                    class="absolute -top-20 -right-20 w-80 h-80 bg-emerald-800 rounded-full blur-[100px] opacity-20">
                                </div>
                                <div class="relative z-10 space-y-6">
                                    <h4 class="text-[11px] font-black uppercase tracking-[0.4em] text-emerald-400">Core
                                        Benefits</h4>
                                    <p
                                        class="text-2xl md:text-3xl font-light leading-relaxed border-l-4 border-emerald-500 pl-6 serif-font italic">
                                        {{ herb.benefits }}
                                    </p>

                                    <div class="pt-6 border-t border-white/10">
                                        <p
                                            class="text-[10px] font-black uppercase tracking-[0.3em] text-emerald-400 mb-4">
                                            Special Action (Prabhav)</p>
                                        <div class="flex flex-wrap gap-2">
                                            <span *ngFor="let p of herb.prabhav"
                                                class="px-4 py-2 bg-white/5 backdrop-blur-md rounded-xl text-[10px] font-black uppercase tracking-widest border border-white/10">
                                                {{ p }}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reduced Footer -->
        <div class="px-8 py-4 bg-white border-t border-stone-100 shrink-0">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-8 h-8 rounded-lg bg-emerald-950 flex items-center justify-center text-sm shadow-lg">üçÉ
                    </div>
                    <p class="text-emerald-950 font-black tracking-tight uppercase text-[14px]">Phyto-profile Synthesis
                        ¬∑
                        Ancient Wisdom Registry</p>
                </div>
                <div class="text-[14px] font-black text-stone-300 uppercase tracking-widest">Ref: #AYU-{{
                    herb.name.substring(0,3).toUpperCase() }}</div>
            </div>
        </div>
    </div>
</div>