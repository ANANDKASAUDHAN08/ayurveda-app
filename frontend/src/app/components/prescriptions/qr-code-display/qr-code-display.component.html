<!-- QR Code Display Component -->
<div class="qr-code-container">
    <!-- Generate Button -->
    <div *ngIf="!showQRCode && !loading" class="text-center">
        <button (click)="generateQRCode()"
            class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all transform hover:scale-105">
            <i class="fa-solid fa-qrcode text-xl"></i>
            <span>Generate Digital QR Code</span>
        </button>
        <p class="text-xs text-gray-500 mt-2">
            <i class="fa-solid fa-info-circle"></i>
            For pharmacy verification
        </p>
    </div>

    <!-- Loading -->
    <div *ngIf="loading" class="text-center py-8">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"></div>
        <p class="text-gray-600 mt-3">Generating QR code...</p>
    </div>

    <!-- Error -->
    <div *ngIf="error" class="bg-red-50 border border-red-200 rounded-lg p-4 text-center">
        <i class="fa-solid fa-exclamation-circle text-red-600 text-2xl mb-2"></i>
        <p class="text-red-700">{{ error }}</p>
        <button (click)="generateQRCode()" class="mt-3 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
            Try Again
        </button>
    </div>

    <!-- QR Code Display -->
    <div *ngIf="showQRCode && qrCodeData" class="bg-white rounded-2xl shadow-xl p-6 border border-gray-200">
        <!-- Header -->
        <div class="flex items-center justify-between mb-6 border-b pb-4">
            <div class="flex items-center gap-3">
                <div
                    class="w-12 h-12 bg-gradient-to-br from-purple-600 to-blue-600 rounded-xl flex items-center justify-center">
                    <i class="fa-solid fa-qrcode text-white text-xl"></i>
                </div>
                <div>
                    <h3 class="text-lg font-bold text-gray-900">Digital Prescription</h3>
                    <p class="text-xs text-gray-500">Scan at pharmacy for verification</p>
                </div>
            </div>
            <button (click)="closeQRCode()" class="text-gray-400 hover:text-gray-600 transition-colors">
                <i class="fa-solid fa-times text-xl"></i>
            </button>
        </div>

        <!-- QR Code Image -->
        <div class="text-center mb-6">
            <div class="inline-block p-4 bg-white border-4 border-gray-200 rounded-xl shadow-inner">
                <img [src]="qrCodeData" alt="Prescription QR Code" class="w-64 h-64">
            </div>
        </div>

        <!-- Verification Code -->
        <div class="bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-xl p-4 mb-6">
            <p class="text-xs font-medium text-gray-600 mb-2 flex items-center gap-2">
                <i class="fa-solid fa-key"></i>
                Verification Code
            </p>
            <div class="flex items-center justify-between">
                <code class="text-2xl font-bold text-purple-700 tracking-wider">{{ verificationCode }}</code>
                <button (click)="copyVerificationCode()"
                    class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 text-sm">
                    <i class="fa-solid fa-copy"></i>
                    Copy
                </button>
            </div>
            <p class="text-xs text-gray-500 mt-2">
                Use this code if QR scanner is unavailable
            </p>
        </div>

        <!-- Instructions -->
        <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mb-6">
            <p class="font-semibold text-blue-900 mb-2 flex items-center gap-2">
                <i class="fa-solid fa-info-circle"></i>
                How to use:
            </p>
            <ol class="text-sm text-blue-800 space-y-1 list-decimal list-inside">
                <li>Show this QR code or verification code at the pharmacy</li>
                <li>Pharmacy will scan to verify prescription details</li>
                <li>Once verified, pharmacy can dispense medicines</li>
                <li>This prevents fraud and ensures accuracy</li>
            </ol>
        </div>

        <!-- Actions -->
        <div class="flex gap-3">
            <button (click)="downloadQRCode()"
                class="flex-1 px-4 py-3 bg-gradient-to-r from-emerald-600 to-green-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2">
                <i class="fa-solid fa-download"></i>
                Download QR Code
            </button>
            <button (click)="copyVerificationCode()"
                class="flex-1 px-4 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2">
                <i class="fa-solid fa-copy"></i>
                Copy Code
            </button>
        </div>

        <!-- Warning -->
        <div class="mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3">
            <p class="text-xs text-yellow-800 flex items-start gap-2">
                <i class="fa-solid fa-exclamation-triangle mt-0.5"></i>
                <span>
                    <strong>Security Notice:</strong> Only share this QR code with authorized pharmacies.
                    The code is unique to this prescription and should not be shared publicly.
                </span>
            </p>
        </div>
    </div>
</div>