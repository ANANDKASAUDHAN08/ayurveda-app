<div (click)="onViewDetails()"
    class="group bg-white rounded-2xl md:rounded-3xl shadow-sm hover:shadow-xl transition-all duration-500 border border-slate-100 hover:border-emerald-200 hover:-translate-y-1.5 overflow-hidden h-full flex flex-col cursor-pointer relative">

    <!-- Top Section: Image/Avatar and Badges -->
    <div class="relative p-3 md:p-4 pb-0">
        <div class="flex items-start justify-between">
            <div class="relative">
                <div
                    class="h-14 w-14 md:h-16 md:w-16 rounded-xl md:rounded-2xl bg-gradient-to-br from-emerald-100 to-teal-50 flex items-center justify-center text-emerald-600 text-xl md:text-2xl font-black shadow-inner group-hover:scale-105 transition-transform duration-500">
                    {{ doctor.name.charAt(0) }}
                </div>
                <!-- Online Status Pulse -->
                <div *ngIf="isOnline"
                    class="absolute -bottom-1 -right-1 w-4 h-4 bg-emerald-500 border-2 border-white rounded-full">
                    <span class="absolute inset-0 rounded-full bg-emerald-500 animate-ping opacity-75"></span>
                </div>
            </div>

            <div class="flex flex-col items-end gap-2">
                <button (click)="toggleFavorite($event)"
                    class="p-2 backdrop-blur-sm transition-all duration-300 hover:bg-white hover:shadow-md"
                    [class.text-red-500]="isFavorite()" [class.text-slate-300]="!isFavorite()">
                    <svg xmlns="http://www.w3.org/2000/svg" [attr.fill]="isFavorite() ? 'currentColor' : 'none'"
                        viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"
                        class="w-5 h-5 transition-transform duration-300" [class.scale-110]="isFavorite()">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" />
                    </svg>
                </button>
                <!-- <span *ngIf="isFree"
                    class="px-2 py-1 bg-amber-100 text-amber-700 text-[10px] font-black uppercase tracking-wider rounded-lg shadow-sm">
                    First Free
                </span> -->
            </div>
        </div>
    </div>

    <!-- Content Section -->
    <div class="p-3 md:p-5 flex-1 flex flex-col">
        <!-- Name and Specialization -->
        <div class="mb-3 md:mb-4">
            <h3
                class="text-sm md:text-base font-extrabold text-slate-800 group-hover:text-emerald-600 transition-colors leading-tight mb-1 line-clamp-2">
                {{ doctor.name }}
            </h3>
            <div class="flex flex-wrap items-center gap-x-1.5 gap-y-1">
                <span
                    class="text-[10px] md:text-[11px] font-bold text-slate-400 uppercase tracking-tight md:tracking-wider truncate max-w-[80px] md:max-w-none">
                    {{ doctor.specialization || 'General Physician' }}
                </span>
                <span class="hidden md:block w-1 h-1 bg-slate-300 rounded-full"></span>
                <span
                    class="px-1 py-0.5 bg-emerald-50 text-emerald-600 text-[8px] md:text-[10px] font-bold rounded-md uppercase">
                    {{ doctor.medicine_type || 'Modern' }}
                </span>
                <span *ngIf="doctor.gender"
                    class="px-1 py-0.5 bg-slate-100 text-slate-600 text-[8px] md:text-[10px] font-bold rounded-md uppercase">
                    {{ doctor.gender }}
                </span>
            </div>
        </div>

        <!-- Rating Section -->
        <div class="mb-3 md:mb-4 flex flex-wrap items-center gap-1.5 md:gap-2">
            <div class="flex items-center bg-yellow-50 px-1.5 md:px-2 py-0.5 md:py-1 rounded-lg">
                <i class="fas fa-star text-yellow-500 text-[9px] md:text-[10px] mr-1 md:mr-1.5"></i>
                <span class="text-[10px] md:text-xs font-black text-yellow-700">{{ (doctor.rating && doctor.rating > 0)
                    ? doctor.rating : 'New' }}</span>
            </div>
            <span class="text-[9px] md:text-[10px] font-medium text-slate-400 truncate">
                {{ (doctor.rating && doctor.rating > 0) ? '(' + (doctor.reviews_count || 0) + ')' : 'No reviews' }}
            </span>
        </div>

        <!-- Innovative Info Grid -->
        <div class="grid grid-cols-2 gap-2 md:gap-3 mb-4 md:mb-6">
            <div
                class="flex items-center gap-1.5 md:gap-2.5 p-1.5 md:p-2 rounded-xl md:rounded-2xl bg-slate-50/50 group-hover:bg-white group-hover:shadow-sm transition-all duration-300">
                <div
                    class="w-6 h-6 md:w-7 md:h-7 rounded-lg md:rounded-xl bg-blue-50 flex items-center justify-center text-blue-500 shrink-0">
                    <i class="fas fa-history text-[9px] md:text-[10px]"></i>
                </div>
                <div class="flex flex-col min-w-0">
                    <span
                        class="text-[8px] md:text-[9px] font-bold text-slate-400 uppercase leading-none mb-0.5">Exp</span>
                    <span class="text-[10px] md:text-xs font-black text-slate-700 truncate">{{ doctor.experience }}+
                        Yrs</span>
                </div>
            </div>
            <div
                class="flex items-center gap-1.5 md:gap-2.5 p-1.5 md:p-2 rounded-xl md:rounded-2xl bg-slate-50/50 group-hover:bg-white group-hover:shadow-sm transition-all duration-300">
                <div
                    class="w-6 h-6 md:w-7 md:h-7 rounded-lg md:rounded-xl bg-emerald-50 flex items-center justify-center text-emerald-500 shrink-0">
                    <i class="fas fa-wallet text-[9px] md:text-[10px]"></i>
                </div>
                <div class="flex flex-col min-w-0">
                    <span
                        class="text-[8px] md:text-[9px] font-bold text-slate-400 uppercase leading-none mb-0.5">Fee</span>
                    <span class="text-[10px] md:text-xs font-black text-slate-700 truncate">â‚¹{{ doctor.consultation_fee
                        || 0 }}</span>
                </div>
            </div>
        </div>

        <!-- Footer Info: Location and Booking -->
        <div class="mt-auto flex items-center justify-between gap-2 md:gap-3">
            <div class="flex items-center gap-1 md:gap-1.5 min-w-0">
                <i class="fas fa-map-marker-alt text-emerald-700 text-[10px]"></i>
                <span class="text-[10px] md:text-[11px] font-semibold text-slate-500 truncate">
                    {{ doctor.location || 'Online Only' }}</span>
            </div>

            <button (click)="$event.stopPropagation(); onBook()"
                class="shrink-0 h-8 md:h-10 px-3 md:px-4 bg-emerald-600 text-white text-[10px] md:text-xs font-black rounded-lg md:rounded-xl hover:bg-emerald-700 hover:scale-105 active:scale-95 shadow-md shadow-emerald-200 transition-all duration-300">
                BOOK
            </button>
        </div>
    </div>
</div>