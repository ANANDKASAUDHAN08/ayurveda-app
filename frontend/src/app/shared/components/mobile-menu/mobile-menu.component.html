<!-- Mobile Bottom Navigation (Fixed) -->
<nav *ngIf="isLoggedIn()"
    class="md:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t-2 border-slate-200 shadow-2xl safe-area-bottom">
    <div class="grid grid-cols-4 h-16">

        <!-- Home -->
        <a routerLink="/home" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
            class="flex flex-col items-center justify-center gap-1 text-slate-600 active:bg-slate-100 transition-colors touch-manipulation">
            <i class="fas fa-home text-xl"></i>
            <span class="text-xs font-medium">Home</span>
        </a>

        <!-- Dashboard -->
        <a routerLink="/user/dashboard" routerLinkActive="active"
            class="flex flex-col items-center justify-center gap-1 text-slate-600 active:bg-slate-100 transition-colors touch-manipulation">
            <i class="fas fa-th-large text-xl"></i>
            <span class="text-xs font-medium">Dashboard</span>
        </a>

        <!-- Emergency (ALWAYS RED) -->
        <a routerLink="/emergency"
            class="flex flex-col items-center justify-center gap-1 text-red-600 active:bg-red-50 transition-colors touch-manipulation">
            <i class="fas fa-ambulance text-xl animate-pulse"></i>
            <span class="text-xs font-medium">SOS</span>
        </a>

        <!-- Menu (Hamburger) -->
        <button (click)="toggleMenu()"
            class="flex flex-col items-center justify-center gap-1 text-slate-600 active:bg-slate-100 transition-colors touch-manipulation">
            <i class="fas fa-bars text-xl"></i>
            <span class="text-xs font-medium">Menu</span>
        </button>

    </div>
</nav>

<!-- Hamburger Slide-in Menu -->
<div *ngIf="isMenuOpen" class="md:hidden fixed inset-0 z-[60]" (click)="closeMenu()">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" [@fadeIn]></div>

    <!-- Menu Panel (Slide from right) -->
    <div (click)="$event.stopPropagation()"
        class="absolute top-0 right-0 bottom-0 w-80 max-w-[85vw] bg-white shadow-2xl overflow-y-auto" [@slideIn]>

        <!-- Menu Header -->
        <div class="bg-gradient-to-r from-emerald-600 to-emerald-700 p-6 text-white">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold">Menu</h2>
                <button (click)="closeMenu()"
                    class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center">
                    <i class="fas fa-user text-2xl"></i>
                </div>
                <div>
                    <p class="font-semibold">{{ authService.getUser()?.name || 'User' }}</p>
                    <p class="text-sm opacity-90">{{ authService.getUser()?.email }}</p>
                </div>
            </div>
        </div>

        <!-- Menu Items -->
        <div class="p-4">

            <!-- Dashboard Section -->
            <div class="mb-6">
                <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3 px-2">Dashboard</h3>
                <a (click)="navigate('/user/dashboard')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-th-large text-emerald-600 w-5"></i>
                    <span class="font-medium text-slate-900">My Dashboard</span>
                </a>
                <a (click)="navigate('/user/profile')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-user-circle text-purple-600 w-5"></i>
                    <span class="font-medium text-slate-900">My Profile</span>
                </a>
            </div>

            <!-- Medical Section -->
            <div class="mb-6">
                <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3 px-2">Medical</h3>
                <a (click)="navigate('/find-doctors')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-user-md text-blue-600 w-5"></i>
                    <span class="font-medium text-slate-900">Find Doctors</span>
                </a>
            </div>

            <!-- Shop Section -->
            <div class="mb-6">
                <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3 px-2">Shop</h3>
                <a (click)="navigate('/medicines')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-pills text-teal-600 w-5"></i>
                    <span class="font-medium text-slate-900">Medicines</span>
                </a>
                <a (click)="navigate('/medical-devices')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-heartbeat text-pink-600 w-5"></i>
                    <span class="font-medium text-slate-900">Medical Devices</span>
                </a>
                <a (click)="navigate('/lab-tests')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-flask text-indigo-600 w-5"></i>
                    <span class="font-medium text-slate-900">Lab Tests</span>
                </a>
                <a (click)="navigate('/orders')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-shopping-bag text-orange-600 w-5"></i>
                    <span class="font-medium text-slate-900">My Orders</span>
                </a>
            </div>

            <!-- Emergency Section -->
            <div class="mb-6">
                <h3 class="text-xs font-bold text-slate-500 uppercase tracking-wider mb-3 px-2">Emergency</h3>
                <a (click)="navigate('/emergency')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl bg-red-50 hover:bg-red-100 active:bg-red-200 transition-colors touch-manipulation border-2 border-red-200">
                    <i class="fas fa-ambulance text-red-600 w-5 animate-pulse"></i>
                    <span class="font-bold text-red-600">Emergency Hub</span>
                </a>
                <a (click)="navigate('/nearby-hospitals')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-hospital text-red-600 w-5"></i>
                    <span class="font-medium text-slate-900">Nearby Hospitals</span>
                </a>
                <a (click)="navigate('/first-aid')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-first-aid text-red-600 w-5"></i>
                    <span class="font-medium text-slate-900">First Aid Guide</span>
                </a>
            </div>

            <!-- Settings Section -->
            <div class="mb-6 border-t border-slate-200 pt-4">
                <a (click)="navigate('/user/settings')"
                    class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation">
                    <i class="fas fa-cog text-slate-600 w-5"></i>
                    <span class="font-medium text-slate-900">Settings</span>
                </a>
                <button (click)="logout()"
                    class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-red-50 active:bg-red-100 text-red-600 transition-colors touch-manipulation">
                    <i class="fas fa-sign-out-alt w-5"></i>
                    <span class="font-medium">Logout</span>
                </button>
            </div>

        </div>
    </div>
</div>

<!-- Spacer for bottom nav (prevent content from being hidden) -->
<div *ngIf="isLoggedIn()" class="h-16 md:hidden"></div>